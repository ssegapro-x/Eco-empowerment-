<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="CONTENT-TYPE" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="description" content="Share your eco-friendly photos and explore contributions from Eco Empowerment founders and our community!">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <title>Eco Empowerment - Gallery</title>
  <style>
    body {
      margin: 0;
      font-family: 'Roboto', sans-serif;
      background-color: #f0fdf4;
      color: #333;
    }

    header {
      background-color: #166534;
      color: white;
      padding: 15px 20px;
      position: fixed;
      width: 100%;
      top: 0;
      left: 0;
      z-index: 1000;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    header h1 {
      font-size: 20px;
    }

    .menu-btn {
      font-size: 24px;
      cursor: pointer;
    }

    .menu-btn:focus, .close-btn:focus, .back-to-top:focus, a:focus {
      outline: 2px solid #d1fae5;
      outline-offset: 2px;
    }

    aside {
      background-color: #065f46;
      color: white;
      width: 200px;
      height: 100%;
      position: fixed;
      top: 0;
      left: -220px !important;
      padding-top: 10px;
      transition: left 0.3s;
      z-index: 3000 !important;
    }

    aside.show {
      left: 0 !important;
    }

    aside .close-btn {
      display: block;
      font-size: 24px;
      text-align: left;
      padding: 10px 20px;
      cursor: pointer;
      background-color: #047857;
    }

    aside a {
      display: flex;
      align-items: center;
      padding: 10px 20px;
      color: white;
      text-decoration: none;
      transition: transform 0.2s;
    }

    aside a:hover {
      background-color: #047857;
      transform: translateX(10px);
    }

    .nav-icon {
      margin-right: 10px;
      font-family: 'Roboto', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';
    }

    .hero {
      background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://images.unsplash.com/photo-1448375240586-882707db888b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80');
      background-size: cover;
      background-position: center;
      height: 300px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      color: white;
      animation: fadeIn 1.5s ease-in-out;
    }

    .hero-content h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
    }

    .hero-content p {
      font-size: 1.2rem;
      max-width: 600px;
    }

    @keyframes fadeIn {
      0% { opacity: 0; transform: translateY(20px); }
      100% { opacity: 1; transform: translateY(0); }
    }

    main {
      padding: 80px 20px 20px 20px;
    }

    section {
      background-color: white;
      margin-bottom: 20px;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    h2 {
      color: #065f46;
    }

    .upload-form {
      text-align: center;
      margin-bottom: 20px;
    }

    .upload-form input[type="file"] {
      padding: 10px;
      margin: 10px 0;
    }

    .upload-form textarea {
      width: 100%;
      max-width: 400px;
      padding: 10px;
      border: 1px solid #065f46;
      border-radius: 6px;
      resize: vertical;
    }

    .upload-form button {
      padding: 10px 20px;
      background-color: #166534;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    .upload-form button:hover {
      background-color: #047857;
    }

    .filter-tabs {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
    }

    .filter-tab {
      padding: 10px 20px;
      background-color: #d1fae5;
      color: #065f46;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    .filter-tab.active {
      background-color: #166534;
      color: white;
    }

    .filter-tab:hover {
      background-color: #bbf7d0;
    }

    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
    }

    .gallery-item {
      background-color: #d1fae5;
      padding: 10px;
      border-radius: 12px;
      text-align: center;
      position: relative;
    }

    .gallery-item img {
      width: 100%;
      height: 200px;
      object-fit: cover;
      border-radius: 8px;
    }

    .gallery-item p {
      font-size: 0.9rem;
      color: #333;
      margin: 10px 0;
    }

    .gallery-item .badge {
      position: absolute;
      top: 10px;
      left: 10px;
      background-color: #065f46;
      color: white;
      padding: 5px 10px;
      border-radius: 6px;
      font-size: 0.8rem;
    }

    .gallery-item .like-btn {
      background: none;
      border: none;
      font-size: 1.2rem;
      cursor: pointer;
      color: #065f46;
      position: absolute;
      bottom: 10px;
      right: 10px;
    }

    .gallery-item .like-btn.liked {
      color: #e53e3e;
    }

    .back-to-top {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #166534;
      color: white;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      font-size: 1.2rem;
      cursor: pointer;
      display: none;
      opacity: 1;
      transition: opacity 0.3s;
    }

    .back-to-top.show {
      display: block;
    }

    footer {
      background-color: #065f46;
      color: white;
      text-align: center;
      padding: 20px;
      margin-top: 20px;
    }

    .social-links a {
      color: white;
      margin: 0 10px;
      font-size: 1.5rem;
      text-decoration: none;
    }

    .social-links a:hover {
      color: #d1fae5;
    }

    .qr-code {
      text-align: center;
      margin-top: 20px;
    }

    .qr-code img {
      width: 100px;
      height: 100px;
      margin-bottom: 10px;
    }

    .qr-code p {
      font-size: 0.9rem;
      color: white;
    }

    @media screen and (min-width: 800px) {
      .menu-btn {
        display: none;
      }
      aside {
        left: 0 !important;
      }
      main {
        margin-left: 200px;
      }
      .hero {
        height: 400px;
      }
      .hero-content h1 {
        font-size: 3rem;
      }
      .hero-content p {
        font-size: 1.4rem;
      }
    }

    @media screen and (max-width: 800px) {
      .hero {
        height: 200px;
      }
      .hero-content h1 {
        font-size: 1.8rem;
      }
      .hero-content p {
        font-size: 1rem;
      }
      .filter-tabs {
        flex-direction: column;
        align-items: center;
      }
    }
  </style>
</head>
<body>
  <header>
    <span class="menu-btn" onclick="toggleSidebar()" aria-label="Open menu">‚ò∞</span>
    <h1>Eco Gallery</h1>
    <div></div>
  </header>
  <p>.</p>
  <p>.</p>
  <section class="hero">
    <div class="hero-content">
      <h1>Share Your Eco Story</h1>
      <p>Join our community by uploading photos of your eco-friendly actions!</p>
    </div>
  </section>

  <aside id="sidebar" role="navigation">
    <span class="close-btn" onclick="toggleSidebar()" aria-label="Close menu">‚úï</span>
    <a href="index.html"><span class="nav-icon">üè†</span> Home</a>
    <a href="about-eco.html"><span class="nav-icon">üå±</span> About</a>
    <a href="eco-projects.html"><span class="nav-icon">üìÇ</span> Projects</a>
    <a href="eco-blog.html"><span class="nav-icon">üì∞</span> Blog</a>
    <a href="eco-resources.html"><span class="nav-icon">üìö</span> Resources</a>
    <a href="get-involved.html"><span class="nav-icon">ü§ù</span> Get Involved</a>
    <a href="eco-gallery.html"><span class="nav-icon">üì∏</span> Gallery</a>
    <a href="contact.html"><span class="nav-icon">üì¨</span> Contact</a>
  </aside>

  <main>
    <section class="upload-section">
      <h2>üì∏ Upload Your Eco Photo</h2>
      <form class="upload-form" id="uploadForm">
        <input type="file" accept="image/*" id="photoInput" required aria-label="Upload eco-friendly photo">
        <textarea id="captionInput" placeholder="Describe your eco-action (e.g., planted a tree in my backyard)" rows="3" maxlength="200" required aria-label="Photo caption"></textarea>
        <button type="submit">Share Photo</button>
      </form>
    </section>

    <section class="gallery-section">
      <h2>üåç Community Gallery</h2>
      <div class="filter-tabs">
        <button class="filter-tab active" data-filter="all" onclick="filterGallery('all')">All</button>
        <button class="filter-tab" data-filter="founders" onclick="filterGallery('founders')">Founders</button>
        <button class="filter-tab" data-filter="public" onclick="filterGallery('public')">Community</button>
      </div>
      <div class="gallery-grid" id="galleryGrid">
        <!-- Gallery items will be added dynamically via JavaScript -->
      </div>
    </section>
  </main>

  <button class="back-to-top" onclick="scrollToTop()" aria-label="Back to top">‚Üë</button>

  <footer>
    <p>&copy; 2025 Eco Empowerment. All rights reserved.</p>
    <div class="social-links">
      <a href="https://twitter.com" target="_blank">üê¶</a>
      <a href="https://instagram.com" target="_blank">üì∑</a>
      <a href="https://facebook.com" target="_blank">üìò</a>
    </div>
    <div class="qr-code">
      <img src="path/to/your-qr-code.png" alt="QR Code for Eco Empowerment Gallery" width="100" height="100">
      <p>Scan to share your eco photos! üåç</p>
    </div>
  </footer>

  <script>
    // Sidebar functionality
    function toggleSidebar() {
      console.log('Toggling sidebar');
      document.getElementById('sidebar').classList.toggle('show');
    }

    window.addEventListener('scroll', function() {
      const backToTop = document.querySelector('.back-to-top');
      if (window.scrollY > 300) {
        backToTop.classList.add('show');
      } else {
        backToTop.classList.remove('show');
      }
    });

    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Firebase setup (replace with your config)
    try {
      const firebaseConfig = {
        apiKey: "your-api-key",
        authDomain: "your-project.firebaseapp.com",
        projectId: "your-project-id",
        storageBucket: "your-project.appspot.com",
        messagingSenderId: "your-id",
        appId: "your-app-id"
      };
      firebase.initializeApp(firebaseConfig);
      const storage = firebase.storage();
      const db = firebase.firestore();
      const auth = firebase.auth();

      // Founder emails
      const founderEmails = ['founder1@ecoempowerment.com', 'founder2@ecoempowerment.com'];

      function isFounder(user) {
        return user && founderEmails.includes(user.email);
      }

      // Upload photo
      document.getElementById('uploadForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        const photoInput = document.getElementById('photoInput');
        const captionInput = document.getElementById('captionInput');
        const file = photoInput.files[0];
        const caption = captionInput.value;
        const user = auth.currentUser;

        if (file && caption) {
          const storageRef = storage.ref(`eco-photos/${Date.now()}_${file.name}`);
          await storageRef.put(file);
          const photoURL = await storageRef.getDownloadURL();
          await db.collection('photos').add({
            photoURL,
            caption,
            likes: 0,
            userType: user && isFounder(user) ? 'founder' : 'public',
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
          });
          alert('Photo uploaded successfully! Awaiting moderation.');
          this.reset();
          loadPhotos('all');
        } else {
          alert('Please select a photo and add a caption.');
        }
      });

      // Load photos with filter
      async function loadPhotos(filter) {
        const galleryGrid = document.getElementById('galleryGrid');
        galleryGrid.innerHTML = '';
        let query = db.collection('photos').orderBy('timestamp', 'desc');
        const snapshot = await query.get();
        snapshot.forEach(doc => {
          const data = doc.data();
          if (filter === 'all' || filter === data.userType) {
            const galleryItem = document.createElement('div');
            galleryItem.classList.add('gallery-item');
            galleryItem.setAttribute('data-type', data.userType);
            galleryItem.innerHTML = `
              <div class="badge">${data.userType === 'founder' ? 'Founder' : 'Community'}</div>
              <img src="${data.photoURL}" alt="${data.caption}">
              <p>${data.caption}</p>
              <button class="like-btn" data-id="${doc.id}" aria-label="Like this photo">‚ù§Ô∏è <span class="like-count">${data.likes}</span></button>
            `;
            galleryGrid.appendChild(galleryItem);
          }
        });
        updateFilterTabs(filter);
      }

      // Filter gallery
      function filterGallery(filter) {
        loadPhotos(filter);
      }

      // Update filter tab styles
      function updateFilterTabs(activeFilter) {
        document.querySelectorAll('.filter-tab').forEach(tab => {
          tab.classList.toggle('active', tab.dataset.filter === activeFilter);
        });
      }

      // Like button functionality
      document.addEventListener('click', async function(e) {
        if (e.target.classList.contains('like-btn')) {
          const docId = e.target.dataset.id;
          const likeCount = e.target.querySelector('.like-count');
          let count = parseInt(likeCount.textContent);
          e.target.classList.toggle('liked');
          const newCount = e.target.classList.contains('liked') ? count + 1 : count - 1;
          likeCount.textContent = newCount;
          await db.collection('photos').doc(docId).update({ likes: newCount });
        }
      });

      // Load photos on page load
      loadPhotos('all');

      // Auth check
      auth.onAuthStateChanged(user => {
        if (!user) {
          document.getElementById('uploadForm').insertAdjacentHTML('beforebegin', '<p><a href="login.html">Log in</a> to upload photos.</p>');
        }
      });
    } catch (error) {
      console.error('Firebase initialization failed:', error);
      // Sidebar still works without Firebase
    }
  </script>
</body>
</html>